{% extends "layout/base.html" %}

{% block head %}
<link href="{{ url_for('static', filename='css/typeahead.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container">
    <!-- <div class="starter-template"> -->
    <div class="page-header">
        <h1>What's happening around you?</h1>
        <p class="lead">Find current social activity that stands out from the background.</p>
    </div>

    <div class ="col-sm-12">

        <div id="map-container" class="col-md-6">
            <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places,visualization&sensor=true_or_false">
            </script>
        </div>

        <!-- The location entry field -->
        <div class ="col-sm-6">
            <div class="well">
                <!-- User-input location -->
                <div class="thumbnail">
                  <div class="caption">
                    <h3 style="color: #ff6600">Where to look?</h3>
                    <p>Type the name of an area to explore</p>
                    <div class="row">       
                        <!-- <form role="form" action="/results" onsubmit='show_loading()' method="GET"> -->
                        <form action="/results_location" method="POST">
                            <div class="col-sm-9">
                                <div class="form-group">
                                    <label for="whereToLook"></label>
                                    <input type="text" name="location" class="form-control" id="whereToLook" placeholder="e.g., Mission Street, San Francisco, CA">
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <button type="submit_loc" style="background-color: #ff6600; color: white;" name="query" class="btn btn-default">Continue</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Predefined location -->
            <div class="thumbnail">
              <div class="caption">
                <h3 style="color: #ff6600">Examples</h3>
                <p>Or choose from these examples</p>
                <form action="/results_predef" method="POST">
                    <div class="col-sm-9">
                        <div class="form-group">
                            <select class="form-control" name="event_id"> <!--# reference in views.py with this name -->
                                {% for event in examples %}
                                <option value="{{ event["id"] }}">{{ event["name"] }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <button type="submit_predef" style="background-color: #ff6600; color: white;" class="btn btn-default">Continue</button>
                    </div>
                </form>

                </div>
            </div>
        </div>
        <!-- Closing the location entry field -->
    </div>

    <!-- Closing map and location input row -->
    </div>

</div><!-- /.container -->

{% endblock %}

<!--==============================================================-->
{% block scripts %}

<script>
function init_map() {
    
    var var_location = new google.maps.LatLng({{ user_lat }}, {{ user_lon }});
    
    var var_ourmap = mapIt(var_location)
    
    function mapIt(v_lat) {
        var var_mapoptions = {
            center: v_lat,
            zoom: 9
            // mapTypeId: google.maps.MapTypeId.SATELLITE
        };

        var var_map = new google.maps.Map(document.getElementById("map-container"),
            var_mapoptions);
            
        // var var_marker = new google.maps.Marker({
        //     position: v_lat,
        //     map: var_map,
        //     title:"You"});

        // // var_marker.setMap(var_map);

        return var_map
    }
    
    function addPinMarker(this_map,thislat,thislong,thisID) {
        var latlong = new google.maps.LatLng(thislat,thislong)

        var this_marker = new google.maps.Marker({
            position: latlong,
            icon: getMakerImage(thisID+1)
            })

        this_marker.setMap(this_map);
    }
    
}

google.maps.event.addDomListener(window, 'load', init_map);
</script>

<script src="{{ url_for('static', filename='js/typeahead.min.js') }}"></script>
<script>
$("document").ready(function(){
    $("#desintationEntry").typeahead({
        name : 'dest',
        hint: false,
        minLength: 1,
        prefetch: '/prefetch/prefetch', 
    });
});
</script>
<script>    
    //autocomplete for whereToLook
    var input = /** @type {HTMLInputElement} */(
      document.getElementById('whereToLook'));
    var autocomplete = new google.maps.places.Autocomplete(input);
    //restrict to Bay Area
    var sw = google.maps.LatLng(37.3333, -122.5311);
    var ne = google.maps.LatLng(37.9736, -121.9000);
    var LatLngBounds = google.maps.LatLngBounds(sw, ne);
    autocomplete.setBounds(LatLngBounds);
</script>

{% endblock %}
<!--=================================================-->

{# commenting out
{% block footer %}
  {% include "include/footer.html" %}
{% endblock %}
#}
